(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{7072:function(e,t,n){Promise.resolve().then(n.bind(n,8446))},8446:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return B}});var r=n(7437),s=n(2265),c=n(6998),o=n(5069),a=n(4952),i=n(6793),l=n(1326),u=n(64),d=n(9889),h=n(5734),m=n(6548),p=n(511),x=n(1504),j=n(6463),g=n(8433),f=n(4990),Z=n(7318),S=n(2674),v=n(6645),C=n(8884),N=n(7116),b=n(6351),y=n(3473),P=n(1656),k=n(4691),w=n(468),E=n(5253),O=n(7590),T=n(7622),_=n(8652),A=n(5410),L=n(7478),I=n(301),D=n(8071),J=n.n(D);let R=["Carrito","Selecionar sucursal","Confirmaci\xf3n"];function z(){let{setShoppingCart:e,shoppingCart:t}=(0,s.useContext)(x.x),n=(0,j.useRouter)(),[E,O]=(0,s.useState)(0),[T,D]=(0,s.useState)(new Set),[z,B]=(0,s.useState)(0),[F,G]=(0,s.useState)({products:[{name:"",price:0,category:"",amount:0}],amountProducts:0}),[H,U]=(0,s.useState)(!1),[W,q]=(0,s.useState)(""),[V,X]=(0,s.useState)("success"),[Y,K]=(0,s.useState)([]),[Q,$]=(0,s.useState)("La granja"),[ee,et]=(0,s.useState)(J()()),[en,er]=(0,s.useState)({hour:-1,minute:-1}),es=e=>T.has(e),ec=n=>{let r=[...F.products];r[n].amount+=1,G({...F,products:r,amountProducts:t.amountProducts+1}),e({...F,amountProducts:t.amountProducts+1,products:r})},eo=n=>{let r=[...F.products];r[n].amount>1&&(r[n].amount-=1,G({...F,products:r,amountProducts:t.amountProducts-1}),e({...F,amountProducts:t.amountProducts-1,products:r}))},ea=e=>{var t;let n=[...F.products],r=(null===(t=n[e])||void 0===t?void 0:t.amount)||1;n.splice(e,1),G({amountProducts:F.amountProducts-r,products:[...n]}),(0,_.bL)(n)},ei=()=>{K([]),F.products.length>0&&fetch("".concat(A.v.backend,"/orders/readAvailableSchedules"),{method:"POST",body:JSON.stringify({date:ee?ee.toString():J()().toString(),branch:Q}),headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat((0,I.C)())}}).then(e=>e.json()).then(e=>{200===e.statusCode&&K(e.data)})};(0,s.useEffect)(()=>{ei();let e=(0,_.dv)(),t=0;e.forEach(e=>{t=(e.amount||0)+t}),G({amountProducts:t,products:e})},[]),(0,s.useEffect)(()=>{ei()},[Q,ee]),(0,s.useEffect)(()=>{let e=0;F.products.forEach(t=>{let n=t.amount||1;e+=t.price*n}),B(e)},[F]);let el=[{key:"primer-hijo",children:(0,r.jsx)("div",{className:"p-0 sm:p-10",children:(0,r.jsxs)(g.ZP,{container:!0,spacing:2,justifyContent:"center",children:[(0,r.jsx)(g.ZP,{item:!0,md:4,lg:4,sm:12,xl:3,children:0!==F.products.length?F.products.map((e,t)=>(0,r.jsx)(M,{price:e.price,productName:e.name,productAmount:e.amount||1,addMoreProduct:()=>{ec(t)},restMoreProduct:()=>{eo(t)},deleteProduct:()=>{ea(t)}},"".concat(e.name,"-cart-").concat(t))):(0,r.jsxs)(f.Z,{elevation:3,className:"p-5 mt-5 sm:mt-0 w-full flex justify-center",children:[(0,r.jsx)(p.Z,{align:"center",children:"No hay ningun producto agregado"}),(0,r.jsx)(c.Z,{})]})}),(0,r.jsx)(g.ZP,{item:!0,md:4,lg:4,sm:12,xl:3,children:(0,r.jsxs)(f.Z,{elevation:4,className:"w-full p-3",children:[(0,r.jsx)(p.Z,{variant:"h4",align:"center",className:"text-blue-500 bolder font-black",children:"Resumen de orden"}),(0,r.jsx)(Z.Z,{}),(0,r.jsx)(S.Z,{children:(0,r.jsx)(v.Z,{children:(0,r.jsxs)(C.Z,{children:[(0,r.jsxs)(N.Z,{children:[(0,r.jsx)(b.Z,{component:"th",scope:"row",children:"TOTAL DE ART\xcdCULOS"}),(0,r.jsx)(b.Z,{align:"right",children:F.amountProducts})]}),(0,r.jsxs)(N.Z,{children:[(0,r.jsx)(b.Z,{component:"th",scope:"row",children:"DESCUENTO(3RA Y 4TA EDAD)"}),(0,r.jsx)(b.Z,{align:"right",children:F.amountProducts})]}),(0,r.jsxs)(N.Z,{children:[(0,r.jsx)(b.Z,{component:"th",className:"font-black",scope:"row",children:"TOTAL"}),(0,r.jsxs)(b.Z,{align:"right",className:"font-black",children:["L. ",z," "]})]})]})})})]})})]})})},{key:"segundo-hijo",children:(0,r.jsx)(g.ZP,{container:!0,spacing:2,justifyContent:"center",className:"p-10",children:(0,r.jsxs)(g.ZP,{item:!0,children:[(0,r.jsx)(a._,{dateAdapter:o.y,children:(0,r.jsx)(i.M,{minDate:J()(),maxDate:J()().add(3,"month"),referenceDate:J()(),className:"my-2 w-3/6",value:ee,onChange:e=>et(e)})}),(0,r.jsx)(y.Z,{id:"select-branch",className:"m-2 w-36 ",select:!0,label:"Selecione sucursal",defaultValue:"La granja",onChange:e=>$(e.target.value),children:["Tepeyac","La granja","aeroplaza"].map((e,t)=>(0,r.jsx)(P.Z,{value:e,children:e},"key-select-".concat(e,"-").concat(t)))}),(0,r.jsx)(S.Z,{className:"h-40",component:f.Z,children:(0,r.jsxs)(v.Z,{children:[(0,r.jsx)(k.Z,{children:(0,r.jsxs)(N.Z,{children:[(0,r.jsx)(b.Z,{children:"Horarios Disponibles"}),(0,r.jsx)(b.Z,{align:"right",children:"Selecionar"})]})}),(0,r.jsx)(C.Z,{children:Y.length>0?Y.map((e,t)=>(0,r.jsxs)(N.Z,{children:[(0,r.jsx)(b.Z,{component:"th",scope:"row",children:function(e,t){var n,r;let s=null==e?void 0:null===(n=e.toString())||void 0===n?void 0:n.padStart(2,"0"),c=null==t?void 0:null===(r=t.toString())||void 0===r?void 0:r.padStart(2,"0");return"".concat(s||"00",":").concat(c||"00")}(e.hour,e.minute)}),(0,r.jsx)(b.Z,{className:"".concat(en.hour===e.hour&&en.minute===e.minute&&"bg-green-700 text-white"," cursor-default"),align:"right",onClick:()=>er(e),children:en.hour===e.hour&&en.minute===e.minute?"Selecionado":"Selecionar"})]},"table-".concat(e.hour).concat(e.minute,"-").concat(t))):(0,r.jsx)(N.Z,{className:"flex align-middle justify-center pt-5",children:(0,r.jsxs)(b.Z,{component:"th",scope:"row",children:["Buscando horarios disponibles ",(0,r.jsx)(w.Z,{})]})})})]})})]})})},{key:"tercer-hijo",children:(0,r.jsx)(g.ZP,{container:!0,spacing:2,justifyContent:"center",className:"p-10",children:(0,r.jsxs)(g.ZP,{item:!0,children:[(0,r.jsx)(p.Z,{align:"center",children:"Tu orden ha sido procesada con exito"}),(0,r.jsx)(p.Z,{align:"center",children:"Como ultimo paso ingresa al siguiente link y haz el pago"}),(0,r.jsx)("div",{className:"flex justify-center p-5",children:(0,r.jsx)(m.Z,{variant:"contained",onClick:()=>{location.assign("http://www.mozilla.org")},children:"Pagar"})})]})})}];return(0,r.jsxs)(l.Z,{sx:{width:"100%"},className:"px-[10%] py-10",children:[(0,r.jsx)(u.Z,{activeStep:E,alternativeLabel:!0,children:R.map((e,t)=>{let n={};return es(t)&&(n.completed=!1),(0,r.jsx)(d.Z,{...n,children:(0,r.jsx)(h.Z,{children:e})},e)})}),el[E].children,(0,r.jsxs)(l.Z,{sx:{display:"flex",flexDirection:"row",pt:2},children:[(0,r.jsx)(m.Z,{onClick:()=>O(E-1),disabled:[0,2].includes(E),children:"Regresar"}),(0,r.jsx)(l.Z,{sx:{flex:"1 1 auto"}}),(0,r.jsx)(m.Z,{onClick:()=>{if(0!==F.products.length){if(1===E){let t,n="";if(Q||(n+="Selecione una sucursal \n"),-1===en.hour&&(n+="Selecione una horario \n"),n){U(!0),q(n);return}let r=localStorage.getItem("user");r&&(t=JSON.parse(r));let s=0;F.products.forEach(e=>{let t=e.amount||1;s+=e.price*t}),fetch("".concat(A.v.backend,"/orders"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat((0,I.C)())},body:JSON.stringify({cart:F.products,userId:t?t._id:"",branch:Q,date:ee?ee.toString():J()().toString(),schedule:en})}).then(e=>e.json()).then(t=>{200===t.statusCode?(e({amountProducts:0,products:[]}),(0,_.bL)([])):(q(t.message),X("error"),U(!0))}).catch(e=>{q(e.toString()),X("error"),U(!0)})}E<2?O(e=>e+1):n.push("/")}},disabled:0===F.products.length,children:E===R.length-1?"Terminar":"Siguiente"})]}),(0,r.jsx)(L.Z,{handleClose:(e,t)=>{"clickaway"!==t&&U(!1)},open:H,message:W,type:V})]})}function M(e){let{productName:t,price:n,productAmount:s,addMoreProduct:c,restMoreProduct:o,deleteProduct:a}=e;return(0,r.jsxs)("div",{className:"flex rounded-lg p-2 mt-5 shadow-md",children:[(0,r.jsxs)("div",{className:"w-3/4",children:[(0,r.jsx)(p.Z,{variant:"body2",children:t}),(0,r.jsxs)(p.Z,{variant:"body2",children:[" L. ",n]})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(E.Z,{className:"text-blue-600 mx-4",onClick:c}),(0,r.jsx)(p.Z,{variant:"subtitle1",children:s}),(0,r.jsx)(O.Z,{className:"text-blue-600 mx-4",onClick:o})]}),(0,r.jsx)(T.Z,{className:"text-red-600 m-1 mx-4",onClick:a})]})]})}function B(){return(0,r.jsx)(x.Z,{children:(0,r.jsx)(z,{})})}},5410:function(e,t,n){"use strict";n.d(t,{v:function(){return r}});let r={backend:"http://18.118.8.253"}},8652:function(e,t,n){"use strict";n.d(t,{Xq:function(){return s},bL:function(){return o},dv:function(){return c}});let r="cart";function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(localStorage.getItem(r)){let n=JSON.parse(localStorage.getItem(r)||"2");n.push({name:e.name,price:e.price,amount:t,_id:e._id}),localStorage.setItem(r,JSON.stringify(n))}else localStorage.setItem(r,JSON.stringify([{name:e.name,price:e.price,amount:t,_id:e._id}]))}function c(){let e=localStorage.getItem(r);return e?JSON.parse(e):[]}function o(e){localStorage.setItem(r,JSON.stringify(e))}},301:function(e,t,n){"use strict";function r(){let e=document.cookie.split(";"),t="";return e.forEach(e=>{let n=e.split("=");"access_token"===n[0].trim()&&(t=n[1])}),t}n.d(t,{C:function(){return r}})},7478:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(7437),s=n(1520),c=n(4818);function o(e){let{message:t,open:n,handleClose:o,type:a,duration:i=3e3}=e;return(0,r.jsx)(s.Z,{anchorOrigin:{vertical:"top",horizontal:"center"},open:n,autoHideDuration:i,onClose:o,children:(0,r.jsx)(c.Z,{onClose:o,severity:a,variant:"filled",sx:{width:"100%"},children:t})})}},1504:function(e,t,n){"use strict";n.d(t,{Z:function(){return Z},x:function(){return g}});var r=n(7437),s=n(2265),c=n(6463),o=n(1733),a=n(1326),i=n(9806),l=n(511),u=n(6548),d=n(2429),h=n(8438),m=n(2508),p=n(6648);n(5410);var x=n(301),j=n(8652);let g=(0,s.createContext)({setShoppingCart:()=>{},shoppingCart:{amountProducts:0,products:[{name:"",price:0,category:""}]}});function f(e){let{children:t}=e,{shoppingCart:n}=(0,s.useContext)(g),j=(0,c.useRouter)(),[f,Z]=s.useState(!1),[S,v]=(0,s.useState)("register"),[C,N]=(0,s.useState)(!1),[b,y]=(0,s.useState)(),P=(e,t)=>()=>{Z(e),v(t)};(0,s.useEffect)(()=>{let e=localStorage.getItem("user");e&&y(JSON.parse(e))},[]),(0,s.useEffect)(()=>{(0,x.C)()||j.push("/")},[]);let k=(0,r.jsxs)(a.Z,{sx:{width:300},role:"presentation",children:[(0,r.jsx)("div",{className:"flex justify-center pl-5 pt-5 pr-5",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(u.Z,{className:"mb-2",variant:"outlined",type:"submit",fullWidth:!0,children:"Mis ordenes"}),(0,r.jsx)(u.Z,{className:"mb-2",variant:"outlined",type:"submit",fullWidth:!0,onClick:()=>{localStorage.removeItem("user"),y(null),document.cookie="access_token=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",Z(!1),j.push("/")},children:"Cerrar sesion"})]})}),(0,r.jsx)(u.Z,{variant:"contained",className:"mx-5 mt-5",onClick:P(!1,"login"),children:"Cerrar"})]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("nav",{children:(0,r.jsxs)(a.Z,{sx:{flexGrow:1},children:[(0,r.jsx)(h.ZP,{anchor:"right",open:f,onClose:P(!1,"login"),children:k}),(0,r.jsx)(o.Z,{position:"static",children:(0,r.jsxs)(i.Z,{children:[(0,r.jsx)(p.default,{src:"/LCM.png",alt:"logo",width:100,height:100,onClick:()=>j.push("/catalog")}),(0,r.jsx)(l.Z,{variant:"h6",component:"div",sx:{flexGrow:1}}),b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{color:"inherit",onClick:P(!0,"user"),children:b.fullName}),(0,r.jsx)(m.Z,{badgeContent:n.amountProducts,color:"warning",children:(0,r.jsx)(d.Z,{onClick:()=>j.push("/shoppingCart")})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{color:"inherit",onClick:P(!0,"register"),children:"Registrarse"}),(0,r.jsx)(u.Z,{color:"inherit",onClick:P(!0,"login"),children:"Ingresar"})]})]})})]})}),(0,r.jsx)("main",{children:t})]})}function Z(e){let{children:t}=e,[n,c]=(0,s.useState)({products:[{name:"",price:0,category:"",amount:0}],amountProducts:0});return(0,s.useEffect)(()=>{let e=(0,j.dv)(),t=0;e.forEach(e=>{t=(e.amount||0)+t}),c({amountProducts:t,products:e})},[]),(0,r.jsx)(g.Provider,{value:{shoppingCart:n,setShoppingCart:c},children:(0,r.jsx)(f,{children:t})})}}},function(e){e.O(0,[276,564,648,89,670,506,478,23,744],function(){return e(e.s=7072)}),_N_E=e.O()}]);