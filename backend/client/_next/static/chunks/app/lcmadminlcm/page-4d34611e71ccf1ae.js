(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[429],{910:function(e,t,a){Promise.resolve().then(a.bind(a,3574))},3574:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return I}});var n=a(7437),s=a(2265),r=a(6463),l=a(8438),c=a(2184),o=a(1807),i=a(511),d=a(7300),u=a(6917),h=a(7588),m=a(4990),x=a(3473),p=a(1656),j=a(8433),f=a(1326),Z=a(9128),g=a(270),v=a(4696),N=a(8549),S=a(8409),b=a(8743),y=a(4526),C=a(3907),_=a(7245),k=a(3023),P=a(8071),A=a.n(P),E=a(5069),O=a(4952),w=a(6793),T=a(5410),D=a(7478),z=a(301);function I(){let e=(0,r.useRouter)(),[t,a]=(0,s.useState)(!1),[P,I]=(0,s.useState)({access_token:null,role:null,_id:null,fullName:null,store:"store"}),[B,J]=(0,s.useState)(""),[M,F]=(0,s.useState)(0),[V,W]=(0,s.useState)(25),[G,H]=(0,s.useState)(0),[L,R]=(0,s.useState)(0),[U,q]=(0,s.useState)(A()()),[K,Q]=(0,s.useState)(A()().add(1,"day")),[X,Y]=(0,s.useState)([{__v:0,_id:"",branch:"",cart:[],createdAt:"",finalPayment:0,reservationDate:{date:0,hour:0,minute:0,month:0,year:0},status:"",updatedAt:"",userId:"",user:[{_id:"",DNI:"",fullName:"",identification:"",telphone:""}],isPayed:!1}]),[$,ee]=(0,s.useState)(!1),[et,ea]=(0,s.useState)(""),[en,es]=(0,s.useState)("error"),[er,el]=(0,s.useState)(""),ec=()=>{a(!0),Y([]),fetch("".concat(T.v.backend,"/orders/readBranchOrder"),{method:"POST",body:JSON.stringify({startAt:null==U?void 0:U.toString(),endAt:null==K?void 0:K.toString(),branchName:P.store,serachWord:"",status:er,limit:V,skip:M}),headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat((0,z.C)())}}).then(e=>e.json()).then(e=>{a(!1),200===e.statusCode?(Y(e.data.orders),H(Math.round(e.data.amount/V))):(ee(!0),ea(e.message))}).catch(e=>{a(!1),ee(!0),ea(e.toString())})},eo=(e,t,a)=>{fetch("".concat(T.v.backend,"/orders/").concat(e),{method:"PUT",body:JSON.stringify({status:t,isPayed:a}),headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat((0,z.C)())}}).then(e=>e.json()).then(e=>{200===e.statusCode?(ee(!0),ea("orden actualizada"),es("success")):(ee(!0),ea(e.error))}).catch(e=>{ee(!0),ea(e.toStroing())})};return(0,s.useEffect)(()=>{ec()},[U,K,er]),(0,s.useEffect)(()=>{let t=localStorage.getItem("user");t?I(JSON.parse(t)):e.push("/")},[]),(0,n.jsxs)("div",{children:[(0,n.jsx)(l.ZP,{className:"w-30 bg-red-800s",variant:"permanent",anchor:"left",children:(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(o.ZP,{children:(0,n.jsx)(i.Z,{variant:"h5",children:P.fullName})}),(0,n.jsx)(o.ZP,{disablePadding:!0,onClick:()=>{localStorage.removeItem("user"),I({access_token:null,role:null,_id:null,fullName:null,store:""}),document.cookie="access_token=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",e.push("/")},children:(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(u.Z,{children:(0,n.jsx)(k.Z,{})}),(0,n.jsx)(h.Z,{primary:"Cerrar secci\xf3n"})]})})]})}),(0,n.jsx)("div",{className:"pl-60 pt-5 pr-5 pb-5 ",children:(0,n.jsxs)(m.Z,{elevation:3,className:"min-h-screen p-5",children:[(0,n.jsxs)("div",{className:"mb-5 mt-3",children:[(0,n.jsx)(x.Z,{select:!0,className:"mx-1 w-1/6",label:"Estado de orden",variant:"outlined",onChange:e=>{el(e.target.value)},children:["en espera","pagada","terminada","cancelada"].map((e,t)=>(0,n.jsx)(p.Z,{value:e,children:e},"key-status-".concat(e,"-").concat(t)))}),(0,n.jsxs)(O._,{dateAdapter:E.y,children:[(0,n.jsx)(w.M,{label:"Fecha de inicio",className:"mx-1",referenceDate:A()(),value:U,onChange:e=>q(e)}),(0,n.jsx)(w.M,{label:"Fecha de Final",className:"mx-1",referenceDate:A()().add(1,"day"),value:K,onChange:e=>Q(e)})]})]}),(0,n.jsxs)(j.ZP,{container:!0,spacing:2,children:[t&&(0,n.jsx)(f.Z,{sx:{width:"100%"},children:(0,n.jsx)(Z.Z,{})})," ",0===X.length?(0,n.jsx)(i.Z,{className:"mt-5 ml-5",variant:"h5",textAlign:"center",children:"No se encontro ninguna orden"}):null==X?void 0:X.map(e=>(0,n.jsx)(j.ZP,{item:!0,sm:12,md:6,lg:4,children:(0,n.jsx)(g.Z,{children:(0,n.jsxs)(v.Z,{children:[(0,n.jsxs)(i.Z,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0,children:[e.user[0].fullName," ",e.user[0].DNI," ",e.user[0].telphone]}),(0,n.jsx)(x.Z,{select:!0,className:"",defaultValue:e.status,fullWidth:!0,label:"Estado de orden",variant:"outlined",onChange:t=>{eo(e._id,t.target.value,e.isPayed)},children:["en espera","terminada","cancelada"].map((e,t)=>(0,n.jsx)(p.Z,{value:e,children:e},"key-status-".concat(e,"-").concat(t)))}),(0,n.jsxs)(i.Z,{sx:{mb:1.5},color:"text.secondary",children:["Total a pagar: L. ",e.finalPayment]}),(0,n.jsxs)(i.Z,{variant:"body2",children:["Sucursal ",e.branch]}),(0,n.jsxs)(N.Z,{children:[(0,n.jsx)(S.Z,{id:"demo-radio-buttons-group-label",children:"Esta Pagado"}),(0,n.jsxs)(b.Z,{row:!0,defaultValue:e.isPayed,name:"radio-buttons-group",className:"flex",onChange:t=>{eo(e._id,e.status,!!t.target.value)},children:[(0,n.jsx)(y.Z,{value:!0,control:(0,n.jsx)(C.Z,{}),label:"Si"}),(0,n.jsx)(y.Z,{value:!1,control:(0,n.jsx)(C.Z,{}),label:"No"})]})]})]})})},e._id))]}),(0,n.jsx)(_.Z,{className:"mt-4",count:G,page:L,color:"primary",onChange:(e,t)=>{F(t*V-V),R(t)}})]})}),(0,n.jsx)(D.Z,{handleClose:()=>{ee(!1),ea(""),es("error")},open:$,message:et,type:en})]})}},5410:function(e,t,a){"use strict";a.d(t,{v:function(){return n}});let n={backend:"http://18.118.8.253"}},301:function(e,t,a){"use strict";function n(){let e=document.cookie.split(";"),t="";return e.forEach(e=>{let a=e.split("=");"access_token"===a[0].trim()&&(t=a[1])}),t}a.d(t,{C:function(){return n}})},7478:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var n=a(7437),s=a(1520),r=a(4818);function l(e){let{message:t,open:a,handleClose:l,type:c,duration:o=3e3}=e;return(0,n.jsx)(s.Z,{anchorOrigin:{vertical:"top",horizontal:"center"},open:a,autoHideDuration:o,onClose:l,children:(0,n.jsx)(r.Z,{onClose:l,severity:c,variant:"filled",sx:{width:"100%"},children:t})})}}},function(e){e.O(0,[276,564,89,310,996,478,23,744],function(){return e(e.s=910)}),_N_E=e.O()}]);